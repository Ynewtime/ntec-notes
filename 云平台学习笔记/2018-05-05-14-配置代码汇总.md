---
layout: post
share: true
title: é…ç½®ä»£ç æ±‡æ€»
date: 2018-05-05
---


### åˆå§‹åŒ–

```
<Huawei>language-mode Chinese  //è®¾ç½®è¯­è¨€æ¨¡å¼
<Huawei>system-view  //ä»ç”¨æˆ·è§†å›¾è¿›å…¥ç³»ç»Ÿè§†å›¾ï¼Œæœ€ç®€ï¼šsys
[Huawei]q  //ctrl+z æˆ–è€…qï¼ˆquitï¼‰é€€å›åˆ°ç”¨æˆ·è§†å›¾
[Huawei-Serial0/0/0]return  //ç›´æ¥é€€å›ç”¨æˆ·è§†å›¾æˆ–è¾“å…¥ä¸¤æ¬¡q
<Huawei>display saved-configuration  //æŸ¥çœ‹å·²ä¿å­˜çš„è·¯ç”±å™¨é…ç½®
<Huawei>display current-configuration  //æŸ¥çœ‹å½“å‰çš„è·¯ç”±å™¨é…ç½®
<Huawei>save  //ä¿å­˜å½“å‰é…ç½®
<Huawei>reset saved-configuration  //æ“¦é™¤å­˜å‚¨è®¾å¤‡ä¸­çš„è·¯ç”±å™¨é…ç½®æ–‡ä»¶
<Huawei>compare configuration  //æ¯”è¾ƒé…ç½®æ–‡ä»¶
```

### æŸ¥çœ‹å’Œæ£€æµ‹å‘½ä»¤

```
dis ospf peer b  //æŸ¥çœ‹é‚»æ¥å…³ç³»
ip routing-table  //æŸ¥çœ‹è·¯ç”±è¡¨
display ip routing-table protocol ospf   //æˆ–è€…ä½¿ç”¨ display ospf routing
display ospf lsdb  //æŸ¥çœ‹OSPFæ•°æ®åº“
```

### Accessæ¥å£å±æ€§é…ç½®

```
[Quidway]display port vlan active GigabitEthernet 0/0/1  //æŸ¥çœ‹æ¥å£é…ç½®
[Quidway]clear configuration interface GigabitEthernet 0/0/1  //åˆ é™¤æ¥å£é…ç½®ä¿¡æ¯
[Quidway-GigabitEthernet-0/0/1]restart  //æ¥å£é‡å¯
[SWA-Ethernet0/1]port link-type access  //é…ç½®ACCESSæ¥å£ç±»å‹
[SWA]vlan 3  //åˆ›å»ºVLAN
[SWA-Ethernet0/1]port default vlan 3  //è®¾ç½®ACCESSæ¥å£PVID
```

### Trunkæ¥å£å±æ€§é…ç½®

```
[SWA-Ethernet0/1]port link-type trunk  //é…ç½®TRUNKæ¥å£ç±»å‹
[SWA]vlan 3  //åˆ›å»ºVLAN
[SWA-Ethernet0/1]port trunk pvid vlan 3  //è®¾ç½®TRUNKæ¥å£PVID
[SWA-Ethernet0/1]port trunk pvid allow-pass vlan 5  //é…ç½®TRUNK-LINKæ‰€å…è®¸é€šè¿‡çš„VLANï¼ˆPermitted VLANï¼‰
```

### Hybridæ¥å£å±æ€§é…ç½®

```
[Quidway-Ethernet1/0/1]port link-type hybrid  //é…ç½®hybridæ¥å£ç±»å‹
[Quidway-Ethernet1/0/1]port hybrid pvid vlan 2  //è®¾ç½®hybridæ¥å£PVID
[Quidway-Ethernet1/0/1]port hybrid pvid untagged vlan 2 99  //é…ç½®hybrid-LINKçš„VLAN List
```

### é…ç½®GVRP

```
[Switch]gvrp
[Switch]intterface e0/1
[Switch-Ethernet0/1]port link-type trunk
[Switch-Ethernet0/1]port trunk allow-pass vlan all
[Switch-Ethernet0/1]gvrp
```

### å•è‡‚è·¯ç”±é…ç½® - äº¤æ¢æœºé…ç½®

```
//é…ç½®ä¸‹è¡ŒVLANä¿¡æ¯
[SW1]vlan 100
[SW1-vlan100]port ethernet 0/1
[SW1]vlan 200
[SW1-vlan200]port ethernet 0/2
//é…ç½®ä¸Šè¡ŒTrunkä¿¡æ¯
[SW1]interface ethernet 0/24
[SW1-Ethernet0/24]port link-type trunk
[SW1-Ethernet0/24]port trunk allow-pass vlan all
```

### å•è‡‚è·¯ç”±é…ç½® - è·¯ç”±å™¨é…ç½®

```
//é…ç½®ç¬¬ä¸€ä¸ªå­æ¥å£
[RT1]interface ethernet 0/1.1
[RT1-Ethernet0/1.1]control-vid 100 dot1q-termination  //å¯¹å­æ¥å£æ§åˆ¶ã€å°è£…
[RT1-Ethernet0/1.1]dot1q-termination vid 100  //vlançš„å°è£…å·ä¸º100
[RT1-Ethernet0/1.1]arp broadcast enable  //å¼€å¯ARPå¹¿æ’­æ¶ˆæ¯ä¼ é€’
[RT1-Ethernet0/1.1]ip address 192.168.10.1 255.255.255.0  //å°†å­æ¥å£çš„IPåœ°å€é…ç½®ä¸ºPC1çš„ç½‘å…³
//é…ç½®ç¬¬äºŒä¸ªå­æ¥å£
[RT1]interface ethernet 0/1.2
[RT1-Ethernet0/1.2]control-vid 200 dot1q-termination  //å¯¹å­æ¥å£æ§åˆ¶ã€å°è£…
[RT1-Ethernet0/1.2]dot1q-termination vid 200  //vlançš„å°è£…å·ä¸º200
[RT1-Ethernet0/1.2]arp broadcast enable  //å¼€å¯ARPå¹¿æ’­æ¶ˆæ¯ä¼ é€’
[RT1-Ethernet0/1.2]ip address 192.168.20.1 255.255.255.0  //å°†å­æ¥å£çš„IPåœ°å€é…ç½®ä¸ºPC2çš„ç½‘å…³
```

### OSPFè·¯ç”±åè®®åŸºç¡€ - åŸºæœ¬é…ç½®

ğŸ”¨ é…ç½®å‘½ä»¤

ğŸ“Œ ä¸‹é¢çš„å‘½ä»¤æ˜¯å•åŒºåŸŸï¼ˆarea 1ï¼‰çš„é…ç½®æ–¹å¼

```bash
//OSPF area 1é…ç½®å‘½ä»¤
[RTA]router id 1.1.1.1  //åœ¨ç³»ç»Ÿè§†å›¾ä¸‹é…ç½®router-idï¼Œä¹Ÿå¯åœ¨ä¸‹ä¸€æ­¥ä¸­çš„ospfè¿›ç¨‹å·åé…ç½®router-idï¼ˆåªé€‚ç”¨äºè¯¥è¿›ç¨‹ï¼‰
[RTA]ospf  //é…ç½®ospfè¿›ç¨‹ï¼Œå¯åŠ è¿›ç¨‹å·ï¼Œé»˜è®¤è¿›ç¨‹å·ä¸º1
[RTA-ospf-1]area 0.0.0.1  //åˆ›å»ºarea 1
[RTA-ospf-1-area-0.0.0.1]network 1.1.1.1 0.0.0.0  //æŠŠLoopbacké€»è¾‘åœ°å€å‘å¸ƒåˆ°area1ä¸­å»
[RTA-ospf-1-area-0.0.0.1]network 10.1.1.0 0.0.0.255  //æŠŠå…¶ä½™çš„ç«¯å£ï¼ˆå¦‚10.1.1.0ï¼‰ä¹Ÿå‘å¸ƒåˆ°area1ä¸­å»
[RTA-ospf-1-area-0.0.0.1]return  //é€€å›åˆ°ç”¨æˆ·è§†å›¾
```

ğŸ“Œ ä¸‹é¢çš„å‘½ä»¤æ˜¯å¤šåŒºåŸŸï¼ˆarea 0 1ï¼‰çš„é…ç½®æ–¹å¼

```bash
[RTB]router id 2.2.2.2  //åœ¨ç³»ç»Ÿè§†å›¾ä¸‹é…ç½®router-idï¼Œä¹Ÿå¯åœ¨ä¸‹ä¸€æ­¥ä¸­çš„ospfè¿›ç¨‹å·åé…ç½®router-idï¼ˆåªé€‚ç”¨äºè¯¥è¿›ç¨‹ï¼‰
[RTB]ospf  //ä½¿èƒ½OSPFè¿›ç¨‹
[RTB-ospf-1]area 0.0.0.1  //åˆ›å»ºarea 1
[RTB-ospf-1-area-0.0.0.1]network 2.2.2.2 0.0.0.0  //æŠŠLoopbacké€»è¾‘åœ°å€å‘å¸ƒåˆ°area1ä¸­å»
[RTB-ospf-1-area-0.0.0.1]network 10.1.1.0 0.0.0.255  //æŠŠå¯¹åº”area 1çš„ç«¯å£ï¼ˆå¦‚10.1.1.0ï¼‰ä¹Ÿå‘å¸ƒåˆ°area1ä¸­å»
[RTB-ospf-1-area-0.0.0.1]q  //è¿”å›åˆ°ospfé…ç½®è§†å›¾
[RTB-ospf-1]area 0  //åˆ›å»ºarea 0
[RTB-ospf-1-area-0.0.0.0]network 10.1.2.0 0.0.0.255  //æŠŠå¯¹åº”area 0çš„ç«¯å£ï¼ˆå¦‚10.1.2.0ï¼‰å‘å¸ƒåˆ°area0ä¸­å»
[RTB-ospf-1-area-0.0.0.0]return  //é€€å›åˆ°ç”¨æˆ·è§†å›¾
```

### é“¾è·¯èšåˆé…ç½®æ¡ˆä¾‹

```bash
int eth-trunk 1
int g 0/0/1
eth-trunk 1
int g 0/0/3
eth-trunk 1
int eth-trunk 1
port link-type trunk
port trunk allow-pass vlan 10  //å¯¹äºè¯¥æ¡èšåˆé“¾è·¯vlan 10çš„æƒ…å†µ
```

### é™æ€è·¯ç”±çš„é…ç½®æ–¹æ³•

```
                ç›®çš„IPåœ°å€/æ©ç 
                      |             -->ä¸‹ä¸€è·³
                      |             |
ip route-static 192.168.1.10 24 10.1.1.1
æˆ–
ip route-static 192.168.1.10 24 ethernet 0/0/0
                                    |
                                    |
                                æœ¬åœ°çš„å‡ºæ¥å£ä¿¡æ¯

//æŸ¥çœ‹è·¯ç”±ä¿¡æ¯
ip routing-table
```

### OSPFçš„é…ç½®æ–¹æ³•

```bash
PC1-------------SW1--------R1------------PC2
IP:20.1.1.10/24                          IP:192.168.1.10/24
1GW:20.1.1.1/24                          GW:192.168.1.1/24
```

```bash
//SW1çš„é…ç½®æ–¹æ³•
vlan batch 2 to 3
int g 0/0/1
port link-type access
port default vlan 2
int g 0/0/2
port link-type access
port default vlan 3
int vlan 2
ip address 20.1.1.1 24
int vlan 3
ip address 10.1.1.1 30
router id 1.1.1.1
ospf 1
area 0
network 1.1.1.1 0.0.0.0
network 20.1.1.0 0.0.0.255
network 10.1.1.0 0.0.0.3
```

```bash
//R1çš„é…ç½®æ–¹æ³•
router id 2.2.2.2
ospf 1
area 0
network 2.2.2.2 0.0.0.0
network 192.168.1.10 0.0.0.255
network 10.1.1.1 0.0.0.3
```

```bash
//æµ‹è¯•
dis ip routing-table
```